package shelfStorageFrame;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import db.TableFill;

public class MainFrame extends JFrame {


	private static final long serialVersionUID = 1L;
	PutGetFrame putGetFrame;
	HistoryFrame historyFrame; 
	JTable mainTable;
	String[] columnNames = new String[7];
	String sql;
	JTextField findText;
	
	public MainFrame(int depName)
	{
		setExtendedState(JFrame.MAXIMIZED_BOTH);
		
		// создание всех инстансов
		JPanel manPanel = new JPanel(); 
		JPanel findPanel = new JPanel();
		JButton putButton = new JButton("Положить");
		JButton findButton = new JButton("Поиск");
		JButton findClear = new JButton("Очистить");
		JButton historyButton = new JButton("История");
		JButton getButton = new JButton("Взять");
		findText = new JTextField(13);
		mainTable = new JTable();
		// создание всех экшенов
		putButton.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				putGetFrame = new PutGetFrame(1);
				putGetFrame.setVisible(true);
			}
		});

		getButton.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				putGetFrame = new PutGetFrame(0);
				putGetFrame.setVisible(true);
			}
		});

		historyButton.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				historyFrame = new HistoryFrame();
				historyFrame.setVisible(true);
			}
		});
	
		findButton.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				if (!findText.getText().equals(""))
				{	
					// TODO вывести результат поиска
					columnNames[0] = "Отделы";
					columnNames[1] = "Пролет";
					columnNames[2] = "Ряд";
					columnNames[3] = "Колонка";
					columnNames[4] = "Артикул";
					columnNames[5] = "Название";
					columnNames[6] = "Количество";
					sql = "SELECT [dep],[global_rows],[rows],[columns],[article],[name],[count] "
							+ "FROM storageView "
							+ " WHERE article = " + findText.getText();
					mainTable.setModel(TableFill.tableModel(sql, columnNames));
				}
				else
				{
					JOptionPane.showMessageDialog(null, "Артикул указан неверно. Введите артикул.");
				}
			}
		});
		
		findClear.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				findText.setText("");
				mainTable.setModel(null);
			}
		});
		
		//
		manPanel.add(putButton);
		manPanel.add(getButton);
		manPanel.add(historyButton);
		findPanel.add(new JLabel("Ввведите артикул для поиска - "));
		findPanel.add(findText);
		findPanel.add(findButton);
		findPanel.add(findClear);

		add(manPanel, BorderLayout.NORTH);
		add( new JScrollPane(mainTable), BorderLayout.CENTER);		
		add(findPanel, BorderLayout.SOUTH);
						
	}
}